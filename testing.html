<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Toggle Link Behavior</title>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Retrieve the state from local storage and set the initial state for all buttons
    var buttons = document.querySelectorAll('.button');
    buttons.forEach(function(button) {
        var state = localStorage.getItem(button.id + 'State');
        if (state === 'active') {
            button.classList.add('active');
            toggleButton(button.id);
        }
    });

    // Set event listeners for buttons
    buttons.forEach(function(button) {
        button.addEventListener('click', function() {
            toggleButton(button.id);
            // Save state to local storage
            localStorage.setItem(button.id + 'State', button.classList.contains('active') ? 'active' : 'inactive');
        });
    });
});

function toggleButton(buttonId) {
    var button = document.getElementById(buttonId);
    button.classList.toggle('active');
    switch (buttonId) {
        case 'useIframe':
            toggleLinkBehavior();
            break;
        case 'no':
            button.classList.contains('active') ? openblob() : closeblob();
            break;
        case 'normal':
            button.classList.contains('active') ? disableLinkBehavior() : toggleLinkBehavior();
            break;
        case 'popup':
            button.classList.contains('active') ? enablePopupBehavior() : disablePopupBehavior();
            break;
    }
}

function toggleLinkBehavior() {
    var useIframe = document.getElementById('useIframe').classList.contains('active');

    var links = document.querySelectorAll('a');

    if (useIframe) {
        links.forEach(function(link) {
            link.onclick = function(event) {
                event.preventDefault(); 
                const html = '<html><title>Link</title><iframe src="' + link.href + '" style="position:fixed; top:0; left:0; bottom:0; right:0; width:100%; height:100%; border:none; margin:0; padding:0; overflow:hidden; z-index:999999;"></iframe></html>';
                const blob = new Blob([html], { type: 'text/html' });
                window.open(URL.createObjectURL(blob));
            };
        });
    } else {
        links.forEach(function(link) {
            link.onclick = null;
        });
    }
}

function toggleButton() {
    var button = document.getElementById('useIframe');
    button.classList.toggle('active');
    toggleLinkBehavior();
}

function toggle2() {
    var button = document.getElementById('no');
    button.classList.toggle('active');
    if (button.classList.contains('active')) {
        openblob();
    } else {
        closeblob();
    }
}

function openblob() {
    var links = document.querySelectorAll('a');
    links.forEach(function(link) {
        link.onclick = function(event) {
            event.preventDefault(); 
            var win = window.open();
            var iframe = win.document.createElement('iframe');
            iframe.style.position = "fixed";
            iframe.style.top = "0";
            iframe.style.left = "0";
            iframe.style.bottom = "0";
            iframe.style.right = "0";
            iframe.style.width = "100%";
            iframe.style.height = "100%";
            iframe.style.border = "none";
            iframe.style.margin = "0";
            iframe.style.padding = "0";
            iframe.style.overflow = "hidden";
            iframe.style.zIndex = "999999";
            iframe.src = link.href;
            win.document.body.appendChild(iframe);
        };
    });
}

function closeblob() {
    var links = document.querySelectorAll('a');
    links.forEach(function(link) {
        link.onclick = null;
    });
}

function normal(){
    var button = document.getElementById('normal');
    button.classList.toggle('active');
    var links = document.querySelectorAll('a');
    if (button.classList.contains('active')) {
        links.forEach(function(link) {
            link.onclick = null;
        });
    } else {
        toggleLinkBehavior();
    }
}

function togglePopupButton() {
    var button = document.getElementById('popup');
    button.classList.toggle('active');
    if (button.classList.contains('active')) {
        enablePopupBehavior();
    } else {
        disablePopupBehavior();
    }
}

function enablePopupBehavior() {
    var links = document.querySelectorAll('a');
    links.forEach(function(link) {
        link.onclick = function(event) {
            event.preventDefault(); 
            var win = window.open('', 'vafor', 'height=300,width=650,screenX=400,screenY=350');
            win.document.write('<html><title>vafor it </title><iframe src="' + link.href + '" style="position:fixed; top:0; left:0; bottom:0; right:0; width:100%; height:100%; border:none; margin:0; padding:0; overflow:hidden; z-index:999999;"></iframe></html>');
        };
    });
}

function disablePopupBehavior() {
    var links = document.querySelectorAll('a');
    links.forEach(function(link) {
        link.onclick = null;
    });
}

function togglePopup() {
    togglePopupButton();
}


</script>
<style>
.button {
    display: inline-block;
    padding: 10px 20px;
    background-color: #007bff;
    color: #fff;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    text-decoration: none;
}
.button.active {
    background-color: #28a745;
}
</style>
</head>
<body>
<div>
    <button id="useIframe" class="button">blob</button>
    <button id="no" class="button">about:blank</button>
    <button id="normal" class="button">default</button>
    <button id="popup" class="button">popup</button>
</div>

<div>
    <a href="https://example.com/page1">Link 1</a>
    <a href="https://example.com/page2">Link 2</a>
    <a href="https://example.com/page3">Link 3</a>
</div>
</body>
</html>
